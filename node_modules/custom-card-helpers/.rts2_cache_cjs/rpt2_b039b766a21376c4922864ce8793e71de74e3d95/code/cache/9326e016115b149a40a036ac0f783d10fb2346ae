{"code":"import { forwardHaptic } from \"./haptic\";\r\nimport { fireEvent } from \"./fire-event\";\r\nimport { navigate } from \"./navigate\";\r\nimport { toggleEntity } from \"./toggle-entity\";\r\nexport const handleAction = (node, hass, config, action) => {\r\n    let actionConfig;\r\n    if (action === \"double_tap\" && config.double_tap_action) {\r\n        actionConfig = config.double_tap_action;\r\n    }\r\n    else if (action === \"hold\" && config.hold_action) {\r\n        actionConfig = config.hold_action;\r\n    }\r\n    else if (action === \"tap\" && config.tap_action) {\r\n        actionConfig = config.tap_action;\r\n    }\r\n    if (!actionConfig) {\r\n        actionConfig = {\r\n            action: \"more-info\",\r\n        };\r\n    }\r\n    if (actionConfig.confirmation &&\r\n        (!actionConfig.confirmation.exemptions ||\r\n            !actionConfig.confirmation.exemptions.some((e) => e.user === hass.user.id))) {\r\n        forwardHaptic(\"warning\");\r\n        if (!confirm(actionConfig.confirmation.text ||\r\n            `Are you sure you want to ${actionConfig.action}?`)) {\r\n            return;\r\n        }\r\n    }\r\n    switch (actionConfig.action) {\r\n        case \"more-info\":\r\n            if (config.entity || config.camera_image) {\r\n                fireEvent(node, \"hass-more-info\", {\r\n                    entityId: config.entity ? config.entity : config.camera_image,\r\n                });\r\n            }\r\n            break;\r\n        case \"navigate\":\r\n            if (actionConfig.navigation_path) {\r\n                navigate(node, actionConfig.navigation_path);\r\n            }\r\n            break;\r\n        case \"url\":\r\n            if (actionConfig.url_path) {\r\n                window.open(actionConfig.url_path);\r\n            }\r\n            break;\r\n        case \"toggle\":\r\n            if (config.entity) {\r\n                toggleEntity(hass, config.entity);\r\n                forwardHaptic(\"success\");\r\n            }\r\n            break;\r\n        case \"call-service\": {\r\n            if (!actionConfig.service) {\r\n                forwardHaptic(\"failure\");\r\n                return;\r\n            }\r\n            const [domain, service] = actionConfig.service.split(\".\", 2);\r\n            hass.callService(domain, service, actionConfig.service_data);\r\n            forwardHaptic(\"success\");\r\n        }\r\n    }\r\n};\r\n//# sourceMappingURL=handle-action.js.map","map":"{\"version\":3,\"file\":\"handle-action.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/handle-action.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,aAAa,EAAE,MAAM,UAAU,CAAC;AACzC,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AACzC,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AACtC,OAAO,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAC;AAG/C,MAAM,CAAC,MAAM,YAAY,GAAG,CAC1B,IAAiB,EACjB,IAAmB,EACnB,MAMC,EACD,MAAc,EACR,EAAE;IACR,IAAI,YAAsC,CAAC;IAE3C,IAAI,MAAM,KAAK,YAAY,IAAI,MAAM,CAAC,iBAAiB,EAAE;QACvD,YAAY,GAAG,MAAM,CAAC,iBAAiB,CAAC;KACzC;SAAM,IAAI,MAAM,KAAK,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE;QAClD,YAAY,GAAG,MAAM,CAAC,WAAW,CAAC;KACnC;SAAM,IAAI,MAAM,KAAK,KAAK,IAAI,MAAM,CAAC,UAAU,EAAE;QAChD,YAAY,GAAG,MAAM,CAAC,UAAU,CAAC;KAClC;IAED,IAAI,CAAC,YAAY,EAAE;QACjB,YAAY,GAAG;YACb,MAAM,EAAE,WAAW;SACpB,CAAC;KACH;IAED,IACE,YAAY,CAAC,YAAY;QACzB,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC,UAAU;YACpC,CAAC,YAAY,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CACxC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,IAAK,CAAC,IAAK,CAAC,EAAE,CACjC,CAAC,EACJ;QACA,aAAa,CAAC,SAAS,CAAC,CAAC;QAEzB,IACE,CAAC,OAAO,CACN,YAAY,CAAC,YAAY,CAAC,IAAI;YAC5B,4BAA4B,YAAY,CAAC,MAAM,GAAG,CACrD,EACD;YACA,OAAO;SACR;KACF;IAED,QAAQ,YAAY,CAAC,MAAM,EAAE;QAC3B,KAAK,WAAW;YACd,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,YAAY,EAAE;gBACxC,SAAS,CAAC,IAAI,EAAE,gBAAgB,EAAE;oBAChC,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,YAAa;iBAC/D,CAAC,CAAC;aACJ;YACD,MAAM;QACR,KAAK,UAAU;YACb,IAAI,YAAY,CAAC,eAAe,EAAE;gBAChC,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC,eAAe,CAAC,CAAC;aAC9C;YACD,MAAM;QACR,KAAK,KAAK;YACR,IAAI,YAAY,CAAC,QAAQ,EAAE;gBACzB,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;aACpC;YACD,MAAM;QACR,KAAK,QAAQ;YACX,IAAI,MAAM,CAAC,MAAM,EAAE;gBACjB,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,MAAO,CAAC,CAAC;gBACnC,aAAa,CAAC,SAAS,CAAC,CAAC;aAC1B;YACD,MAAM;QACR,KAAK,cAAc,CAAC,CAAC;YACnB,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE;gBACzB,aAAa,CAAC,SAAS,CAAC,CAAC;gBACzB,OAAO;aACR;YACD,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;YAC7D,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,OAAO,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;YAC7D,aAAa,CAAC,SAAS,CAAC,CAAC;SAC1B;KACF;AACH,CAAC,CAAC\"}","dts":{"name":"/home/iantrich/Projects/hass/plugins/custom-card-helpers/handle-action.d.ts","writeByteOrderMark":false,"text":"import { HomeAssistant, ActionConfig } from \"./types\";\r\nexport declare const handleAction: (node: HTMLElement, hass: HomeAssistant, config: {\r\n    entity?: string;\r\n    camera_image?: string;\r\n    hold_action?: ActionConfig;\r\n    tap_action?: ActionConfig;\r\n    double_tap_action?: ActionConfig;\r\n}, action: string) => void;\r\n"}}
